<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:composition template="#{bootstrap.elements['template-location']}">

        <ui:define name="main-program-panel">
            <h:panelGroup id="search" layout="block" class="row" >
                <h:form id="form-file-finder"><!--impt! cannot be an EL because on render it would wipe out the entire view-->
                    <div id="search-panel" class="col-lg-3">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">Search Files</h3>
                            </div>
                            <div class="panel-body">
                                <div class="mbl">
                                    <h:inputText id="search-file-name" class="form-control" value="#{ProgramFile.formFileFinder.searchName}"/>
                                    <p:watermark for="search-file-name" value="Search Filename" />
                                </div>
                                <div class="mbl">
                                    <span class="label label-default">Uploaded after:</span>
                                    <p:calendar placeholder="DD.MM.YYYY" pattern="dd.mm.yyyy" 
                                                value="#{ProgramFile.formFileFinder.searchStartDate}" 
                                                />
                                    <span class="label label-default">Uploaded before:</span>
                                    <p:calendar placeholder="DD.MM.YYYY" pattern="dd.mm.yyyy" 
                                                value="#{ProgramFile.formFileFinder.searchEndDate}"
                                                />
                                    <p:commandButton value="Search" styleClass="btn btn-default btn-primary" 
                                                     actionListener="#{ProgramFile.formFileFinder.search()}"
                                                     update="@form"/>
                                    <p:commandButton value="Reset" styleClass="btn btn-default "
                                                     actionListener="#{ProgramFile.formFileFinder.reset()}"
                                                     update="@form"/>
                                    <p:commandButton value="Reset all" styleClass="btn btn-default "
                                                     actionListener="#{ProgramFile.resetAll()}"
                                                     update="@form"/>
                                </div>
                                <div style=" font-size: 12px;">
                                    <c:forEach items="#{facesContext.messageList}" var="m">
                                        <div class="alert alert-danger" >
                                            <strong>#{m.summary}</strong><br />
                                            #{m.detail}
                                        </div>
                                    </c:forEach>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h:panelGroup id="results-panel" class="col-lg-3">

                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">Search Results</h3>
                            </div>
                            <div class="panel-body">
                                <c:forEach items="#{ProgramFile.formFileFinder.results}" var="f">
                                    <select class="selectpicker" >
                                        <dt>#{f.FILENAME}</dt>
                                        <option value="0" >
                                            <h:commandLink >
                                                <f:ajax listener="#{ProgramFile.loadFileInEditingPanel()}"
                                                        render=":form-file-editor"
                                                        event="click" />    
                                                #{f.FILENAME}
                                            </h:commandLink>
                                        </option>
                                        <option value="1" >
                                            Edit #{f.FILENAME}
                                        </option>

                                    </select>
                                </c:forEach>
                            </div>
                        </div>
                    </h:panelGroup>
                    <script type="text/javascript">
                        $(document).ready(function() {
                            $('.selectpicker').selectpicker({style: 'btn  btn-wide btn-primary', menuStyle: 'dropdown-inverse'});
                        });
                    </script>
                </h:form>
                <h:panelGroup id="editing-panel" class="col-lg-6">
                    <h:form id="form-file-editor">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">Editing Panel</h3>
                            </div>
                            <div class="panel-body">
                                #{ProgramFile.formFileEditor.testName}
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon">Filename</span>
                                        <input type="text" class="form-control" placeholder=""
                                               c:value="#{ProgramFile.formFileEditor.testName}"/>
                                        
                                    </div>
                                </div>      
                            </div>
                        </div>
                    </h:form>
                </h:panelGroup>

            </h:panelGroup>


        </ui:define>

    </ui:composition>
</html>

